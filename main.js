!function(){"use strict";const e={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__submit-button",inactiveButtonClass:"modal__submit-button-disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},t=(e,t,o)=>{e.querySelector(`#${t.id}-error`).textContent="",t.classList.remove(o.inputErrorClass)},o=(e,t,o)=>{(e=>e.some(e=>!e.validity.valid))(e)?r(t,o):n(t,o)},r=(e,t)=>{e.classList.add(t.inactiveButtonClass),e.disabled=!0},n=(e,t)=>{e.classList.remove(t.inactiveButtonClass),e.disabled=!1},a=(e,r)=>{const n=Array.from(e.querySelectorAll(r.inputSelector)),a=e.querySelector(r.submitButtonSelector);n.forEach(o=>{t(e,o,r)}),o(n,a,r)},l=document.querySelector(".profile__edit-button"),s=document.querySelector("#edit-profile-modal"),c=document.forms["profile-form"],i=s.querySelector("#profile-name-input"),u=s.querySelector("#profile-description-input"),d=document.querySelector(".profile__new-post-button"),m=document.querySelector("#new-post-modal"),p=m.querySelector(".modal__form"),_=m.querySelector("#card-image-input"),f=m.querySelector("#card-caption-input"),y=document.querySelector(".profile__name"),v=document.querySelector(".profile__description"),S=document.querySelector("#preview-modal"),g=S.querySelector(".modal__image"),q=S.querySelector(".modal__caption"),h=document.querySelector("#card-template").content.querySelector(".card"),b=document.querySelector(".cards__list");function w(e,t="prepend"){const o=function(e){const t=h.cloneNode(!0),o=t.querySelector(".card__title"),r=t.querySelector(".card__image");return r.src=e.link,r.alt=e.name,o.textContent=e.name,t.querySelector(".card__like-button").addEventListener("click",e=>{e.target.classList.toggle("card__like-button_active")}),t.querySelector(".card__delete-button").addEventListener("click",()=>{t.remove()}),r.addEventListener("click",()=>{g.src=e.link,g.alt=e.name,q.textContent=e.name,k(S)}),t}(e);b[t](o)}function k(e){function t(t){"Escape"===t.key&&E(e)}function o(t){t.target===e&&E(e)}e.classList.add("modal_is-opened"),e.addEventListener("click",o),document.addEventListener("keydown",t),e._escHandler=t,e._overlayHandler=o}function E(t){t.classList.remove("modal_is-opened");const o=t.querySelector(".modal__form");o&&a(o,e),t._escHandler&&document.removeEventListener("keydown",t._escHandler),t._overlayHandler&&t.removeEventListener("click",t._overlayHandler)}var L;[{name:"Golden Gate Bridge",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/7-photo-by-griffin-wooldridge-from-pexels.jpg"},{name:"Val Thorens",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/1-photo-by-moritz-feldmann-from-pexels.jpg"},{name:"Restaurant terrace",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/2-photo-by-ceiline-from-pexels.jpg"},{name:"An outdoor cafe",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/3-photo-by-tubanur-dogan-from-pexels.jpg"},{name:"A very long bridge, over the forest and through the trees",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/4-photo-by-maurice-laschet-from-pexels.jpg"},{name:"Tunnel with morning light",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/5-photo-by-van-anh-nguyen-from-pexels.jpg"},{name:"Mountain house",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/6-photo-by-moritz-feldmann-from-pexels.jpg"}].forEach(e=>w(e,"append")),document.querySelectorAll(".modal__close-button").forEach(e=>{const t=e.closest(".modal");e.addEventListener("click",()=>E(t))}),l.addEventListener("click",()=>{i.value=y.textContent,u.value=v.textContent,k(s)}),c.addEventListener("submit",e=>{e.preventDefault(),y.textContent=i.value,v.textContent=u.value,E(s)}),d.addEventListener("click",()=>k(m)),p.addEventListener("submit",t=>{t.preventDefault(),w({name:f.value,link:_.value}),a(p,e),E(m)}),L=e,document.querySelectorAll(L.formSelector).forEach(e=>{((e,r)=>{const n=Array.from(e.querySelectorAll(r.inputSelector)),a=e.querySelector(r.submitButtonSelector);o(n,a,r),n.forEach(l=>{l.addEventListener("input",()=>{((e,o,r)=>{o.validity.valid?t(e,o,r):((e,t,o,r)=>{e.querySelector(`#${t.id}-error`).textContent=o,t.classList.add(r.inputErrorClass)})(e,o,o.validationMessage,r)})(e,l,r),o(n,a,r)})})})(e,L)})}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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eUIsRUFBcUI4QyxNQUNqRHRDLEVBQXFCakMsWUFBYzBCLEVBQTRCNkMsTUFDL0RULEVBQVd4QyxLQUdiSyxFQUFjeUIsaUJBQWlCLFFBQVMsSUFBTUksRUFBVTVCLElBRXhEQyxFQUFZdUIsaUJBQWlCLFNBQVdRLElBQ3RDQSxFQUFJWSxpQkFPSmhDLEVBTGdCLENBQ2RXLEtBQU1wQixFQUF3QndDLE1BQzlCdEIsS0FBTW5CLEVBQWtCeUMsUUFJMUJ4RCxFQUFvQmMsRUFBYTFDLEdBQ2pDMkUsRUFBV2xDLEtENUZvQi9CLEVDK0ZoQlYsRUQ5RkVrQyxTQUFTSCxpQkFBaUJyQixFQUFPVCxjQUN6QytCLFFBQVN4QixJQWxCTThFLEVBQUM5RSxFQUFhRSxLQUN0QyxNQUFNTyxFQUFZWSxNQUFNQyxLQUN0QnRCLEVBQVl1QixpQkFBaUJyQixFQUFPUixnQkFFaENnQixFQUFnQlYsRUFBWUcsY0FBY0QsRUFBT1Asc0JBRXZEYSxFQUFrQkMsRUFBV0MsRUFBZVIsR0FFNUNPLEVBQVVlLFFBQVN2QixJQUNqQkEsRUFBYXdELGlCQUFpQixRQUFTLEtBNUNoQnNCLEVBQUMvRSxFQUFhQyxFQUFjQyxLQUNoREQsRUFBYVksU0FBU0MsTUFRekJmLEVBQWVDLEVBQWFDLEVBQWNDLEdBekJ2QjhFLEVBQUNoRixFQUFhQyxFQUFjZ0YsRUFBYy9FLEtBQ25DRixFQUFZRyxjQUN0QyxJQUFJRixFQUFhRyxZQUVDQyxZQUFjNEUsRUFDbENoRixFQUFhSyxVQUFVWSxJQUFJaEIsRUFBT0wsa0JBYWhDbUYsQ0FDRWhGLEVBQ0FDLEVBQ0FBLEVBQWFpRixrQkFDYmhGLElBdUNBNkUsQ0FBbUIvRSxFQUFhQyxFQUFjQyxHQUM5Q00sRUFBa0JDLEVBQVdDLEVBQWVSLFFBUTlDNEUsQ0FBa0I5RSxFQUFhRSxJIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy9zY3JpcHRzL3ZhbGlkYXRpb24uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy9wYWdlcy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY29uc3QgdmFsaWRhdGlvbkNvbmZpZyA9IHtcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19zdWJtaXQtYnV0dG9uXCIsXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX3N1Ym1pdC1idXR0b24tZGlzYWJsZWRcIixcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCIsXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yX3Zpc2libGVcIixcbn07XG5cbmNvbnN0IHNob3dJbnB1dEVycm9yID0gKGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIGVycm9yTWVzc2FnZSwgY29uZmlnKSA9PiB7XG4gIGNvbnN0IGVycm9yTWVzc2FnZUVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgIGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxuICApO1xuICBlcnJvck1lc3NhZ2VFbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xuICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZChjb25maWcuaW5wdXRFcnJvckNsYXNzKTtcbn07XG5cbmNvbnN0IGhpZGVJbnB1dEVycm9yID0gKGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIGNvbmZpZykgPT4ge1xuICBjb25zdCBlcnJvck1lc3NhZ2VFbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICBgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcbiAgKTtcbiAgZXJyb3JNZXNzYWdlRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XG4gIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5pbnB1dEVycm9yQ2xhc3MpO1xufTtcblxuY29uc3QgY2hlY2tJbnB1dFZhbGlkaXR5ID0gKGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIGNvbmZpZykgPT4ge1xuICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xuICAgIHNob3dJbnB1dEVycm9yKFxuICAgICAgZm9ybUVsZW1lbnQsXG4gICAgICBpbnB1dEVsZW1lbnQsXG4gICAgICBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2UsXG4gICAgICBjb25maWdcbiAgICApO1xuICB9IGVsc2Uge1xuICAgIGhpZGVJbnB1dEVycm9yKGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIGNvbmZpZyk7XG4gIH1cbn07XG5cbmNvbnN0IGhhc0ludmFsaWRJbnB1dCA9IChpbnB1dExpc3QpID0+IHtcbiAgcmV0dXJuIGlucHV0TGlzdC5zb21lKChpbnB1dCkgPT4gIWlucHV0LnZhbGlkaXR5LnZhbGlkKTtcbn07XG5cbmNvbnN0IHRvZ2dsZUJ1dHRvblN0YXRlID0gKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgY29uZmlnKSA9PiB7XG4gIGlmIChoYXNJbnZhbGlkSW5wdXQoaW5wdXRMaXN0KSkge1xuICAgIGRpc2FibGVCdXR0b24oYnV0dG9uRWxlbWVudCwgY29uZmlnKTtcbiAgfSBlbHNlIHtcbiAgICBlbmFibGVCdXR0b24oYnV0dG9uRWxlbWVudCwgY29uZmlnKTtcbiAgfVxufTtcblxuY29uc3QgZGlzYWJsZUJ1dHRvbiA9IChidXR0b25FbGVtZW50LCBjb25maWcpID0+IHtcbiAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XG59O1xuXG5jb25zdCBlbmFibGVCdXR0b24gPSAoYnV0dG9uRWxlbWVudCwgY29uZmlnKSA9PiB7XG4gIGJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gIGJ1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSBmYWxzZTtcbn07XG5cbmNvbnN0IHNldEV2ZW50TGlzdGVuZXJzID0gKGZvcm1FbGVtZW50LCBjb25maWcpID0+IHtcbiAgY29uc3QgaW5wdXRMaXN0ID0gQXJyYXkuZnJvbShcbiAgICBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5pbnB1dFNlbGVjdG9yKVxuICApO1xuICBjb25zdCBidXR0b25FbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3Rvcihjb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xuXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgY29uZmlnKTtcblxuICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XG4gICAgICBjaGVja0lucHV0VmFsaWRpdHkoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgY29uZmlnKTtcbiAgICAgIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgY29uZmlnKTtcbiAgICB9KTtcbiAgfSk7XG59O1xuXG5leHBvcnQgY29uc3QgZW5hYmxlVmFsaWRhdGlvbiA9IChjb25maWcpID0+IHtcbiAgY29uc3QgZm9ybUxpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5mb3JtU2VsZWN0b3IpO1xuICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWxlbWVudCkgPT4ge1xuICAgIHNldEV2ZW50TGlzdGVuZXJzKGZvcm1FbGVtZW50LCBjb25maWcpO1xuICB9KTtcbn07XG5cbmV4cG9ydCBjb25zdCByZXNldEZvcm1WYWxpZGF0aW9uID0gKGZvcm1FbGVtZW50LCBjb25maWcpID0+IHtcbiAgY29uc3QgaW5wdXRMaXN0ID0gQXJyYXkuZnJvbShcbiAgICBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5pbnB1dFNlbGVjdG9yKVxuICApO1xuICBjb25zdCBidXR0b25FbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3Rvcihjb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xuXG4gIGlucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICBoaWRlSW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBjb25maWcpO1xuICB9KTtcblxuICB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIGNvbmZpZyk7XG59O1xuXG4vL2V4cG9ydCB7IGVuYWJsZVZhbGlkYXRpb24sIHZhbGlkYXRpb25Db25maWcsIHJlc2V0Rm9ybVZhbGlkYXRpb24gfTtcbiIsImltcG9ydCBcIi4vaW5kZXguY3NzXCI7XG5pbXBvcnQge1xuICBlbmFibGVWYWxpZGF0aW9uLFxuICB2YWxpZGF0aW9uQ29uZmlnLFxuICByZXNldEZvcm1WYWxpZGF0aW9uLFxufSBmcm9tIFwiLi4vc2NyaXB0cy92YWxpZGF0aW9uLmpzXCI7XG5cbmNvbnN0IGluaXRpYWxDYXJkcyA9IFtcbiAge1xuICAgIG5hbWU6IFwiR29sZGVuIEdhdGUgQnJpZGdlXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzctcGhvdG8tYnktZ3JpZmZpbi13b29sZHJpZGdlLWZyb20tcGV4ZWxzLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJWYWwgVGhvcmVuc1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy8xLXBob3RvLWJ5LW1vcml0ei1mZWxkbWFubi1mcm9tLXBleGVscy5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiUmVzdGF1cmFudCB0ZXJyYWNlXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzItcGhvdG8tYnktY2VpbGluZS1mcm9tLXBleGVscy5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiQW4gb3V0ZG9vciBjYWZlXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzMtcGhvdG8tYnktdHViYW51ci1kb2dhbi1mcm9tLXBleGVscy5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiQSB2ZXJ5IGxvbmcgYnJpZGdlLCBvdmVyIHRoZSBmb3Jlc3QgYW5kIHRocm91Z2ggdGhlIHRyZWVzXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzQtcGhvdG8tYnktbWF1cmljZS1sYXNjaGV0LWZyb20tcGV4ZWxzLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJUdW5uZWwgd2l0aCBtb3JuaW5nIGxpZ2h0XCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzUtcGhvdG8tYnktdmFuLWFuaC1uZ3V5ZW4tZnJvbS1wZXhlbHMuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIk1vdW50YWluIGhvdXNlXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzYtcGhvdG8tYnktbW9yaXR6LWZlbGRtYW5uLWZyb20tcGV4ZWxzLmpwZ1wiLFxuICB9LFxuXTtcblxuY29uc3QgZWRpdFByb2ZpbGVCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYnV0dG9uXCIpO1xuY29uc3QgZWRpdFByb2ZpbGVNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdC1wcm9maWxlLW1vZGFsXCIpO1xuY29uc3QgZWRpdFByb2ZpbGVGb3JtID0gZG9jdW1lbnQuZm9ybXNbXCJwcm9maWxlLWZvcm1cIl07XG5jb25zdCBlZGl0UHJvZmlsZU5hbWVJbnB1dCA9IGVkaXRQcm9maWxlTW9kYWwucXVlcnlTZWxlY3RvcihcbiAgXCIjcHJvZmlsZS1uYW1lLWlucHV0XCJcbik7XG5jb25zdCBlZGl0UHJvZmlsZURlc2NyaXB0aW9uSW5wdXQgPSBlZGl0UHJvZmlsZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXG4gIFwiI3Byb2ZpbGUtZGVzY3JpcHRpb24taW5wdXRcIlxuKTtcblxuY29uc3QgbmV3UG9zdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fbmV3LXBvc3QtYnV0dG9uXCIpO1xuY29uc3QgbmV3UG9zdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNuZXctcG9zdC1tb2RhbFwiKTtcbmNvbnN0IG5ld1Bvc3RGb3JtID0gbmV3UG9zdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG5jb25zdCBuZXdQb3N0VGl0bGVJbnB1dCA9IG5ld1Bvc3RNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtaW1hZ2UtaW5wdXRcIik7XG5jb25zdCBuZXdQb3N0RGVzY3JpcHRpb25JbnB1dCA9IG5ld1Bvc3RNb2RhbC5xdWVyeVNlbGVjdG9yKFxuICBcIiNjYXJkLWNhcHRpb24taW5wdXRcIlxuKTtcblxuY29uc3QgcHJvZmlsZU5hbWVFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fbmFtZVwiKTtcbmNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbkVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiKTtcblxuY29uc3QgcHJldmlld01vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcmV2aWV3LW1vZGFsXCIpO1xuY29uc3QgcHJldmlld0ltYWdlRWwgPSBwcmV2aWV3TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2VcIik7XG5jb25zdCBwcmV2aWV3Q2FwdGlvbkVsID0gcHJldmlld01vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2NhcHRpb25cIik7XG5cbmNvbnN0IGNhcmRUZW1wbGF0ZSA9IGRvY3VtZW50XG4gIC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtdGVtcGxhdGVcIilcbiAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpO1xuY29uc3QgY2FyZHNMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlzdFwiKTtcblxuZnVuY3Rpb24gZ2V0Q2FyZEVsZW1lbnQoZGF0YSkge1xuICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmRUZW1wbGF0ZS5jbG9uZU5vZGUodHJ1ZSk7XG4gIGNvbnN0IGNhcmRUaXRsZUVsID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKTtcbiAgY29uc3QgY2FyZEltYWdlRWwgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xuXG4gIGNhcmRJbWFnZUVsLnNyYyA9IGRhdGEubGluaztcbiAgY2FyZEltYWdlRWwuYWx0ID0gZGF0YS5uYW1lO1xuICBjYXJkVGl0bGVFbC50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcblxuICBjYXJkRWxlbWVudFxuICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpXG4gICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICAgICAgZS50YXJnZXQuY2xhc3NMaXN0LnRvZ2dsZShcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcbiAgICB9KTtcblxuICBjYXJkRWxlbWVudFxuICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2RlbGV0ZS1idXR0b25cIilcbiAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIGNhcmRFbGVtZW50LnJlbW92ZSgpO1xuICAgIH0pO1xuXG4gIGNhcmRJbWFnZUVsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgcHJldmlld0ltYWdlRWwuc3JjID0gZGF0YS5saW5rO1xuICAgIHByZXZpZXdJbWFnZUVsLmFsdCA9IGRhdGEubmFtZTtcbiAgICBwcmV2aWV3Q2FwdGlvbkVsLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xuICAgIG9wZW5Nb2RhbChwcmV2aWV3TW9kYWwpO1xuICB9KTtcblxuICByZXR1cm4gY2FyZEVsZW1lbnQ7XG59XG5cbmZ1bmN0aW9uIHJlbmRlckNhcmQoaXRlbSwgbWV0aG9kID0gXCJwcmVwZW5kXCIpIHtcbiAgY29uc3QgY2FyZEVsZW1lbnQgPSBnZXRDYXJkRWxlbWVudChpdGVtKTtcbiAgY2FyZHNMaXN0W21ldGhvZF0oY2FyZEVsZW1lbnQpO1xufVxuXG5pbml0aWFsQ2FyZHMuZm9yRWFjaCgoaXRlbSkgPT4gcmVuZGVyQ2FyZChpdGVtLCBcImFwcGVuZFwiKSk7XG5cbmZ1bmN0aW9uIG9wZW5Nb2RhbChtb2RhbCkge1xuICBtb2RhbC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfaXMtb3BlbmVkXCIpO1xuXG4gIGZ1bmN0aW9uIGhhbmRsZUVzY0Nsb3NlKGV2dCkge1xuICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSBjbG9zZU1vZGFsKG1vZGFsKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGhhbmRsZU92ZXJsYXlDbG9zZShldnQpIHtcbiAgICBpZiAoZXZ0LnRhcmdldCA9PT0gbW9kYWwpIGNsb3NlTW9kYWwobW9kYWwpO1xuICB9XG5cbiAgbW9kYWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGhhbmRsZU92ZXJsYXlDbG9zZSk7XG4gIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGhhbmRsZUVzY0Nsb3NlKTtcblxuICBtb2RhbC5fZXNjSGFuZGxlciA9IGhhbmRsZUVzY0Nsb3NlO1xuICBtb2RhbC5fb3ZlcmxheUhhbmRsZXIgPSBoYW5kbGVPdmVybGF5Q2xvc2U7XG59XG5cbmZ1bmN0aW9uIGNsb3NlTW9kYWwobW9kYWwpIHtcbiAgbW9kYWwuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX2lzLW9wZW5lZFwiKTtcblxuICBjb25zdCBmb3JtID0gbW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbiAgaWYgKGZvcm0pIHtcbiAgICByZXNldEZvcm1WYWxpZGF0aW9uKGZvcm0sIHZhbGlkYXRpb25Db25maWcpO1xuICB9XG5cbiAgaWYgKG1vZGFsLl9lc2NIYW5kbGVyKVxuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIG1vZGFsLl9lc2NIYW5kbGVyKTtcbiAgaWYgKG1vZGFsLl9vdmVybGF5SGFuZGxlcilcbiAgICBtb2RhbC5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgbW9kYWwuX292ZXJsYXlIYW5kbGVyKTtcbn1cblxuZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbF9fY2xvc2UtYnV0dG9uXCIpLmZvckVhY2goKGJ1dHRvbikgPT4ge1xuICBjb25zdCBwb3B1cCA9IGJ1dHRvbi5jbG9zZXN0KFwiLm1vZGFsXCIpO1xuICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IGNsb3NlTW9kYWwocG9wdXApKTtcbn0pO1xuXG5lZGl0UHJvZmlsZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBlZGl0UHJvZmlsZU5hbWVJbnB1dC52YWx1ZSA9IHByb2ZpbGVOYW1lRWwudGV4dENvbnRlbnQ7XG4gIGVkaXRQcm9maWxlRGVzY3JpcHRpb25JbnB1dC52YWx1ZSA9IHByb2ZpbGVEZXNjcmlwdGlvbkVsLnRleHRDb250ZW50O1xuICBvcGVuTW9kYWwoZWRpdFByb2ZpbGVNb2RhbCk7XG59KTtcblxuZWRpdFByb2ZpbGVGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xuICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgcHJvZmlsZU5hbWVFbC50ZXh0Q29udGVudCA9IGVkaXRQcm9maWxlTmFtZUlucHV0LnZhbHVlO1xuICBwcm9maWxlRGVzY3JpcHRpb25FbC50ZXh0Q29udGVudCA9IGVkaXRQcm9maWxlRGVzY3JpcHRpb25JbnB1dC52YWx1ZTtcbiAgY2xvc2VNb2RhbChlZGl0UHJvZmlsZU1vZGFsKTtcbn0pO1xuXG5uZXdQb3N0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiBvcGVuTW9kYWwobmV3UG9zdE1vZGFsKSk7XG5cbm5ld1Bvc3RGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xuICBldnQucHJldmVudERlZmF1bHQoKTtcblxuICBjb25zdCBuZXdDYXJkID0ge1xuICAgIG5hbWU6IG5ld1Bvc3REZXNjcmlwdGlvbklucHV0LnZhbHVlLFxuICAgIGxpbms6IG5ld1Bvc3RUaXRsZUlucHV0LnZhbHVlLFxuICB9O1xuXG4gIHJlbmRlckNhcmQobmV3Q2FyZCk7XG4gIHJlc2V0Rm9ybVZhbGlkYXRpb24obmV3UG9zdEZvcm0sIHZhbGlkYXRpb25Db25maWcpO1xuICBjbG9zZU1vZGFsKG5ld1Bvc3RNb2RhbCk7XG59KTtcblxuZW5hYmxlVmFsaWRhdGlvbih2YWxpZGF0aW9uQ29uZmlnKTtcbiJdLCJuYW1lcyI6WyJ2YWxpZGF0aW9uQ29uZmlnIiwiZm9ybVNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJoaWRlSW5wdXRFcnJvciIsImZvcm1FbGVtZW50IiwiaW5wdXRFbGVtZW50IiwiY29uZmlnIiwicXVlcnlTZWxlY3RvciIsImlkIiwidGV4dENvbnRlbnQiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJ0b2dnbGVCdXR0b25TdGF0ZSIsImlucHV0TGlzdCIsImJ1dHRvbkVsZW1lbnQiLCJzb21lIiwiaW5wdXQiLCJ2YWxpZGl0eSIsInZhbGlkIiwiaGFzSW52YWxpZElucHV0IiwiZGlzYWJsZUJ1dHRvbiIsImVuYWJsZUJ1dHRvbiIsImFkZCIsImRpc2FibGVkIiwicmVzZXRGb3JtVmFsaWRhdGlvbiIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiZWRpdFByb2ZpbGVCdXR0b24iLCJkb2N1bWVudCIsImVkaXRQcm9maWxlTW9kYWwiLCJlZGl0UHJvZmlsZUZvcm0iLCJmb3JtcyIsImVkaXRQcm9maWxlTmFtZUlucHV0IiwiZWRpdFByb2ZpbGVEZXNjcmlwdGlvbklucHV0IiwibmV3UG9zdEJ1dHRvbiIsIm5ld1Bvc3RNb2RhbCIsIm5ld1Bvc3RGb3JtIiwibmV3UG9zdFRpdGxlSW5wdXQiLCJuZXdQb3N0RGVzY3JpcHRpb25JbnB1dCIsInByb2ZpbGVOYW1lRWwiLCJwcm9maWxlRGVzY3JpcHRpb25FbCIsInByZXZpZXdNb2RhbCIsInByZXZpZXdJbWFnZUVsIiwicHJldmlld0NhcHRpb25FbCIsImNhcmRUZW1wbGF0ZSIsImNvbnRlbnQiLCJjYXJkc0xpc3QiLCJyZW5kZXJDYXJkIiwiaXRlbSIsIm1ldGhvZCIsImNhcmRFbGVtZW50IiwiZGF0YSIsImNsb25lTm9kZSIsImNhcmRUaXRsZUVsIiwiY2FyZEltYWdlRWwiLCJzcmMiLCJsaW5rIiwiYWx0IiwibmFtZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwidGFyZ2V0IiwidG9nZ2xlIiwib3Blbk1vZGFsIiwiZ2V0Q2FyZEVsZW1lbnQiLCJtb2RhbCIsImhhbmRsZUVzY0Nsb3NlIiwiZXZ0Iiwia2V5IiwiY2xvc2VNb2RhbCIsImhhbmRsZU92ZXJsYXlDbG9zZSIsIl9lc2NIYW5kbGVyIiwiX292ZXJsYXlIYW5kbGVyIiwiZm9ybSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJidXR0b24iLCJwb3B1cCIsImNsb3Nlc3QiLCJ2YWx1ZSIsInByZXZlbnREZWZhdWx0Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJjaGVja0lucHV0VmFsaWRpdHkiLCJzaG93SW5wdXRFcnJvciIsImVycm9yTWVzc2FnZSIsInZhbGlkYXRpb25NZXNzYWdlIl0sInNvdXJjZVJvb3QiOiIifQ==